{
    "_class" : "com.zwayam.mongodb.models.CommonQueries",
    "companyId" : "14977",
    "queryName" : "VendorPerformanceReport",
    "query" : "SELECT (SELECT v.partner_name FROM c3_vendor v WHERE v.id = ja.vendor_referral_id) AS Partner, IF(rfv.value = '1.1', 'Sub Con', 'Permanent') AS 'Job type', COUNT(DISTINCT ja.job_id) AS 'Sourced Jobs', sum(j.positions_req) AS 'Positions Opened', COUNT(DISTINCT ja.id) AS 'Total Profiles', SUM(IF(ja.current_status = 'Pending', 1, 0)) AS 'Pending', SUM(IF(ja.current_status = 'Assessment Conducted', 1, 0)) AS 'Assessment Conducted', SUM(IF(ja.current_status = 'HM Screening Pending', 1, 0)) AS 'HM Screening Pending', SUM(IF(ja.current_status = 'HM Shortlisted', 1, 0)) AS 'HM Shortlisted', SUM(IF(ja.current_status = 'HM Rejected', 1, 0)) AS 'HM Rejected', SUM(IF(ja.current_status = 'HM On Hold', 1, 0)) AS 'HM On Hold', SUM(IF(ja.current_status = 'Recruiter Screening Selected', 1, 0)) AS 'Recruiter Screening Selected', SUM(IF(ja.current_status = 'Recruiter Screening Rejected', 1, 0)) AS 'Recruiter Screening Rejected', SUM(IF(ja.current_status = 'L1-Interview Scheduled', 1, 0)) AS 'L1-Interview Scheduled', SUM(IF(ja.current_status = 'L1-Interview Selected', 1, 0)) AS 'L1-Interview Selected', SUM(IF(ja.current_status = 'L1-Interview Rejected', 1, 0)) AS 'L1-Interview Rejected', SUM(IF(ja.current_status = 'L1A-Interview Scheduled', 1, 0)) AS 'L1A-Interview Scheduled', SUM(IF(ja.current_status = 'L1A-Interview Selected', 1, 0)) AS 'L1A-Interview Selected', SUM(IF(ja.current_status = 'L1A-Interview Rejected', 1, 0)) AS 'L1A-Interview Rejected', SUM(IF(ja.current_status = 'L2-Interview Scheduled', 1, 0)) AS 'L2-Interview Scheduled', SUM(IF(ja.current_status = 'L2-Interview Selected', 1, 0)) AS 'L2-Interview Selected', SUM(IF(ja.current_status = 'L2-Interview Rejected', 1, 0)) AS 'L2-Interview Rejected', SUM(IF(ja.current_status = 'L3-Interview Scheduled', 1, 0)) AS 'L3-Interview Scheduled', SUM(IF(ja.current_status = 'L3-Interview Selected', 1, 0)) AS 'L3-Interview Selected', SUM(IF(ja.current_status = 'L3-Interview Rejected', 1, 0)) AS 'L3-Interview Rejected', SUM(IF(ja.current_status = 'HR-Interview Scheduled', 1, 0)) AS 'HR-Interview Scheduled', SUM(IF(ja.current_status = 'HR-Interview Selected', 1, 0)) AS 'HR-Interview Selected', SUM(IF(ja.current_status = 'HR-Interview Rejected', 1, 0)) AS 'HR-Interview Rejected', SUM(IF(ja.current_status = 'Client-Interview Scheduled', 1, 0)) AS 'Client-Interview Scheduled', SUM(IF(ja.current_status = 'Client-Interview Selected', 1, 0)) AS 'Client-Interview Selected', SUM(IF(ja.current_status = 'Client-Interview Rejected', 1, 0)) AS 'Client-Interview Rejected', SUM(IF(ja.current_status = 'Rejected', 1, 0)) AS 'Rejected', SUM(IF(ja.current_status = 'Final Selected', 1, 0)) AS 'Final Selected', SUM(IF(ja.current_status = 'Not Selected', 1, 0)) AS 'Not Selected', SUM(IF(ja.current_status = 'Fitment Initiated', 1, 0)) AS 'Fitment Initiated', SUM(IF(ja.current_status = 'Fitment L1 Pending', 1, 0)) AS 'Fitment L1 Pending', SUM(IF(ja.current_status = 'Fitment L1 Approved', 1, 0)) AS 'Fitment L1 Approved', SUM(IF(ja.current_status = 'Fitment L1 Rejected', 1, 0)) AS 'Fitment L1 Rejected', SUM(IF(ja.current_status = 'Fitment L2 Approved', 1, 0)) AS 'Fitment L2 Approved', SUM(IF(ja.current_status = 'Fitment L3 Approved', 1, 0)) AS 'Fitment L3 Approved', SUM(IF(ja.current_status = 'Could Not Offer', 1, 0)) AS 'Could Not Offer', SUM(IF(ja.current_status = 'Offer Sent', 1, 0)) AS 'Offer Sent', SUM(IF(ja.current_status = 'SOW Sent', 1, 0)) AS 'SOW Sent', SUM(IF(ja.current_status = 'Offer Withdrawn', 1, 0)) AS 'Offer Withdrawn', SUM(IF(ja.current_status = 'Offer Modified', 1, 0)) AS 'Offer Modified', SUM(IF(ja.current_status = 'Offer Accepted', 1, 0)) AS 'Offer Accepted', SUM(IF(ja.current_status = 'SOW Accepted', 1, 0)) AS 'SOW Accepted', SUM(IF(ja.current_status = 'Offer Rejected', 1, 0)) AS 'Offer Rejected', SUM(IF(ja.current_status = 'Joined', 1, 0)) AS 'Joined', SUM(IF(ja.current_status = 'Not Joined', 1, 0)) AS 'Not Joined', SUM(IF(ja.current_status = 'On Hold', 1, 0)) AS 'On Hold', SUM(IF(ja.current_status = 'To be Hired', 1, 0)) AS 'To be Hired' FROM c3_job_application ja JOIN c3_job j ON ja.job_id = j.id JOIN c3_requisition_field_values rfv ON ja.job_id = rfv.requisition_id JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id $conditions$ GROUP BY ja.vendor_referral_id , IF(rfv.value = '1.1', 'Sub Con', 'Permanent') HAVING COUNT(DISTINCT ja.id) > 1",
    "fileName" : "VendorPerformanceReport.csv",
    "displayName" : "Vendor Performance Report (.csv)",
    "conditions" : "WHERE ja.company_id = 14977 AND ja.source = 'Partner' AND rf.field_name = 'Requisition Grade' and ((j.department_id IN ($departmentIds$) or j.id IN (SELECT job_id FROM c3_job_collaboration WHERE user_id = $userId$ )) or j.company_id = (SELECT companyId FROM UserRoleGroup WHERE user_id = $userId$ AND roleCode = 'Analytics Team'))",
    "actions" : null,
    "filterConditions" : {
        "fromDate" : "ja.date_applied >= '$fromDate$'",
        "toDate" : "ja.date_applied <= '$toDate$'",
        "location" : "j.location in ($location$)",
        "jobStatus" : "j.status = '$jobStatus$'"
    },
    "batchLimit" : 1000,
    "joiningTables" : {
        "c3_job_collaboration" : "join c3_job_collaboration jcol on j.id = jcol.job_id"
    }
}
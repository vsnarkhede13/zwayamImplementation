{
  "_class": "com.zwayam.mongodb.models.CommonQueries",
  "companyId": "14977",
  "queryName": "JobsReport",
  "query": "SELECT j.reference_number as 'Indent Id', ( SELECT username from c3_user where id =( select user_id from c3_job_collaboration where job_id = j.id limit 1 ) ) as 'Collaborator', ( CASE WHEN j.is_requisition = 'Y' THEN ( SELECT username from c3_user where id = j.created_by limit 1 ) else 'Not Available' END ) as 'Req Created By', ( CASE WHEN j.is_requisition = 'Y' THEN ( SELECT username from c3_user where id = j.requisition_approved_by limit 1 ) else 'Not Available' END ) as 'Req Approved By', ( CASE WHEN j.is_requisition = 'Y' THEN Date_format(j.requisition_approved_date, '%d-%m-%Y' ) else 'Not Available' END ) as 'Req Approved On', j.recruiter_name as 'Recruiter Name', j.job_code as 'Job Code', j.job_title as 'Job Title', Date_format(j.created_date, '%d-%m-%Y' ) as 'Created Date', j.location as 'Location', j.min_yrs_of_experience as 'Min Experience', j.max_yrs_of_experience as 'Max Experience', j.skill_set as 'Skills', j.desired_skill as 'Desired Skills', j.designation as 'Designation', j.positions_req as 'Open Positions', j.qualification as 'Qualification', j.salary as 'Salary', ( case when j.job_visibilty = 'N' then 'Normal' when j.job_visibilty = 'L' then 'Limited' when j.job_visibilty = 'P' then 'Private' when j.job_visibilty = 'E' then 'Enhanced' else 'Normal' end ) as 'Job Visibility', ( select username from c3_user where id = j.modified_by_user_id limit 1 ) as 'Modified By', Date_format(j.modified_date, '%d-%m-%Y' ) as 'Modified Date', ( select username from c3_user where id = j.created_by limit 1 ) 'Created By',( case when j.status = 1 and j.is_requisition = 'N' then 'Open' when j.status = 2 and j.is_requisition = 'N' then 'Hidden' when j.is_requisition = 'Y' and j.job_type = 'R' then 'Pending Requisition' when j.status = 1 and j.is_requisition = 'Y' and j.job_type = 'J' then 'Open' else 'Closed' end ) as 'Job Status', ( case when j.is_requisition = 'Y' then 'Requisition' else 'Job' end ) as 'Type', count(ja.id) as 'Total Applies', count( case when ja.final_recommendation = 'Shortlist' then ja.id end ) as 'Recommended', count( case when ja.current_status = 'Pending' then ja.id end ) as 'Pending', count( case when ja.current_status = 'Recruiter Screening Selected' then ja.id end ) as 'Shortlisted', count( case when ja.current_status = 'Rejected' then ja.id end ) as 'Rejected', count( case when ja.current_status = 'Final Selected' then ja.id end ) as 'Final Selected', count( case when ja.current_status = 'On Hold' then ja.id end ) as 'On Hold', count( case when ja.current_status = 'Documents Requested' then ja.id end ) as 'Documents Requested', count( case when ja.current_status = 'Interview Canceled' then ja.id end ) as 'Interview Canceled', count( case when ja.current_status = 'Interview Selected' then ja.id end ) as 'Interview Selected', count( case when ja.current_status = 'Interview Rejected' then ja.id end ) as 'Interview Rejected', count( case when ja.current_status = 'Offer Made' then ja.id end ) as 'Offer Made', count( case when ja.current_status = 'Offer Sent' then ja.id end ) as 'Offer Sent', count( case when ja.current_status = 'Offer Accepted' then ja.id end ) as 'Offer Accepted', count( case when ja.current_status = 'Offer Rejected' then ja.id end ) as 'Offer Rejected', count( case when ja.current_status = 'Offer Revoked' then ja.id end ) as 'Offer Revoked', ( select department_name from c3_department where id = j.department_id limit 1 ) as 'Department', replace(j.deptFullCode, '.', '/') as 'Dept Structure', ( case when ( select count(jv.id) from c3_job_vendor_distribution jv where j.id = jv.job_id limit 1 ) > 0 then 'Yes' else 'No' end ) as 'Partner Enabled', ( case when ( select referralEnabled from c3_job_employee_distribution where job_id = j.id limit 1 ) = 1 then 'Yes' else 'No' end ) as 'Refferal Enabled', ( case when ( select IjpEnabled from c3_job_employee_distribution where job_id = j.id limit 1 ) = 1 then 'Yes' else 'No' end ) as 'Internal Job Posting', ( SELECT rfv.value FROM c3_requisition_field_values rfv JOIN c3_requisition_fields rf on rfv.requisition_field_id = rf.id and rf.field_name LIKE '%Requisition Type%' WHERE rfv.requisition_id = j.id LIMIT 1 ) as 'Requisition Type' from c3_job j left join c3_job_application ja on ja.job_id = j.id and ja.is_active = 1 $conditions$  group by j.id",
  "conditions": "where j.company_id = $companyId$ and ((j.department_id in ($departmentIds$) or j.id in (select job_id from c3_job_collaboration where user_id=$userId$)) or j.company_id = (select companyId from UserRoleGroup where user_id= $userId$ and roleCode = 'Analytics Team'))",
  "filterConditions": {
      "fromDate": "j.created_date >= '$fromDate$' ",
      "toDate": "j.created_date <= '$toDate$' ",
      "department": " j.deptFullCode in ($department$) ",
      "location": "j.location in ($location$) ",
      "hiringManager": "j.hiring_manager in ($hiringManager$) ",
      "recruiter": "jcol.user_id in ($recruiter$) ",
      "jobStatus": "j.status = '$jobStatus$'"
  },
  "joiningTables": {
      "c3_job_collaboration": " join c3_job_collaboration jcol on j.id = jcol.job_id "
  },
  "fileName": "JobsReport.csv",
  "displayName": "Jobs Report (.csv)"
}
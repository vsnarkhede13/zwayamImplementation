{
    "companyId": "14977",
    "queryName": "ProbableJoineeReport",
    "batchLimit": 5000,
    "query": "select date_format(curdate(), '%d-%m-%y') as 'Report Request Date', date_format(current_time(), '%r') as 'Report Request Time', ja.id as 'Candidate ID', concat(ja.first_name, ' ', ja.last_name) as 'Candidate Name', ja.first_name as 'First Name', ja.last_name as 'Last Name', j.hiring_manager as 'Hiring Manager', ja.current_status as 'Offer Status', j.job_title as 'Indent Title', if(j.status = 1, 'Open', 'Closed') as 'Indent Status', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Hire Type' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Hire Type', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'TypeOfHire' limit 1 ) as 'Offer Type of Hire', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'joiningdate' limit 1 ) as 'Joining Date', ( select DATE_FORMAT(fieldValue, '%M') from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'joiningdate' limit 1 ) AS 'Joining Month', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'contractdate' limit 1 ) as 'Contract End Date', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Opportunity/Project Name' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Opportunity/Project Name', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Business Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Business Unit', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Department Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Department Unit', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'grade' limit 1 ) as 'Grade', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Assignment Location' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Assignment Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'loc' limit 1 ) as 'Offer Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'wloc' limit 1 ) as 'Base Location', ( select if( ( select count(id) > 0 from c3_offernfitment_custom where applicantId = ja.id and fieldName = 'salaryStructure' and ( (fieldValue = 'India-SubCon') or (fieldValue = 'US-C2C') or (fieldValue = 'Canada-C2C') ) limit 1 ),( select fieldValue from c3_offernfitment_custom where applicantId = ja.id and fieldName = 'workAddress' limit 1 ), '' ) ) as 'Work Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'InternalCode' limit 1 ) as 'Internal Location Code', (select if((select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'workAddress' limit 1 )='WFH',(select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'address1' limit 1 ),(select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'isworklocation' limit 1 ))) as 'Address of Work Location', ja.email_id as 'Email', j.skill_set as 'Primary Skill', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'jobTitle' limit 1 ) as 'Designation', ( CASE WHEN LOCATE('\"EType\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"EType\"', ja.applyFieldsObject) + 9, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"EType\"', ja.applyFieldsObject) + 9 ) - (LOCATE('\"EType\"', ja.applyFieldsObject) + 9) ), ',', '' ) ELSE '' END ) AS 'Employment Type', ( CASE WHEN LOCATE('\"experience\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"experience\"', ja.applyFieldsObject) + 14, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"experience\"', ja.applyFieldsObject) + 14 ) - ( LOCATE('\"experience\"', ja.applyFieldsObject) + 14 ) ), ',', '' ) ELSE '' END ) AS 'Total Experience', ( CASE WHEN LOCATE('\"trexp\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"trexp\"', ja.applyFieldsObject) + 9, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"trexp\"', ja.applyFieldsObject) + 9 ) - (LOCATE('\"trexp\"', ja.applyFieldsObject) + 9) ), ',', '' ) ELSE '' END ) AS 'Relevant Experience', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Recruiter ID' WHERE rfv.requisition_id = j.id LIMIT 1 ) AS 'Recruiter ID', ( select ( CASE WHEN LOCATE( '\"fieldName\":\"Recruiter Name\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43 ) - ( LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43 ) ) WHEN LOCATE( '\"fieldName\": \"Recruiter Name\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43 ) - ( LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43 ) ) ELSE '' END ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Recruiter Name', ( select date_format(aa.actedOn, '%d-%m-%y') from ApplyAction as aa where aa.applyId = ja.id and aa.actionCode = 'To be Hired' order by aa.id desc limit 1 ) as 'To Be Hired On', ( case when j.deptFullCode like '%.US%' then 'United States' when j.deptFullCode like '%United States.%' then 'United States' when j.deptFullCode like 'persistent.North America.Industry.Industrial Services.PLM Services' then 'North America' when j.deptFullCode like '%UK.%' then 'United Kingdom' when j.deptFullCode like '%APJ.%' then 'Asia Pacific' when j.deptFullCode like '%EU.%' then 'Europe' when j.deptFullCode like '%CAN%' then 'Canada' when j.deptFullCode like '%Canada.%' then 'Canada' when j.deptFullCode like '%MEX.%' then 'Mexico' when j.deptFullCode like '%Mexico%' then 'Mexico' when j.deptFullCode like '%India.%' then 'India' when j.deptFullCode like '%.India%' then 'India' when j.deptFullCode like '%Australia.%' then 'Australia' when j.deptFullCode like '%Sri Lanka%' then 'Sri Lanka' when j.deptFullCode like '%Netherlands.%' then 'Netherlands' when j.deptFullCode like '%MENA.%' then 'Middle east and North Africa' else 'RoW' end ) as 'Indent Country',(select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId =ja.id and fieldName = 'country' limit 1) as 'Offered Country', '' as 'Visa Type/Green Card/EAD/Citizen Value', '' as 'Office Laptop Required?', '' as 'Office Phone Required?', '' as 'If H1 then I-94 Start Date', '' as 'If H1 then I-94 End Date', '' as 'Address of Residence (Line 2)', '' as 'City of Residence', '' as 'State/Prov of Residence', '' as 'Country of Residence', '' as 'Zip Code of Residence', ( select ( CASE WHEN LOCATE( '\"fieldName\":\"Job Family\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39 ) - ( LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39 ) ) WHEN LOCATE( '\"fieldName\": \"Job Family\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39 ) - ( LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39 ) ) ELSE '' END ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Job Family', ja.phone_no as 'Mobile Phone', (SUBSTRING(ja.applyFieldsObject, LOCATE('\"formerEmployee\"', ja.applyFieldsObject) + length('\"formerEmployee\":\"'), LOCATE(',', ja.applyFieldsObject, LOCATE('\"formerEmployee\"', ja.applyFieldsObject)) - LOCATE('\"formerEmployee\"', ja.applyFieldsObject) - (length('\"formerEmployee\":\"') + 1))) as 'Is Ex-Employee?', (SUBSTRING(ja.applyFieldsObject, LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject) + length('\"pleaseshareyourEmployeeId\":\"'), LOCATE(',', ja.applyFieldsObject, LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject)) - LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject) - (length('\"pleaseshareyourEmployeeId\":\"') + 1))) as 'If yes Employee No.', ( select date_format( ( CASE WHEN LOCATE( '\"fieldName\":\"Contract End Date\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46 ) - ( LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46 ) ) WHEN LOCATE( '\"fieldName\": \"Contract End Date\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46 ) - ( LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46 ) ) ELSE '' END ), '%d-%m-%y' ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Contract End Date', j.reference_number as 'Candidate Identifier', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Organization Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'OU', '' as 'Geography', '' as 'Laptop Shipment Address Line 1', '' as 'Laptop Shipment Address Line 2', '' as 'Laptop Shipment City', '' as 'Laptop Shipment State', '' as 'Laptop Shipment Country', '' as 'Laptop Shipment Zipcode' from c3_job_application ja join c3_job as j on ja.job_id = j.id $conditions$",
    "fileName": "companyProbableJoineeReport.csv",
    "displayName": "Probable Joinee Report (.csv)",
    "conditions": "where ja.company_id = (select distinct companyId from UserRoleGroup where user_id= $userId$ and ((roleCode = 'Admin') or (roleCode = 'Analytics Team')) limit 1) and ja.current_status = 'To be Hired'",
    "filterConditions": {
        "fromDate": "ja.date_applied >= '$fromDate$' ",
        "toDate": "ja.date_applied <= '$toDate$' ",
        "recruiter": "jcol.user_id in ($recruiter$) ",
        "location": "j.location in ($location$) ",
        "department": " j.deptFullCode in ($department$) ",
        "hiringManager": "j.hiring_manager in ($hiringManager$) ",
        "jobStatus": "j.status = '$jobStatus$'"
    },
    "joiningTables": {
        "c3_job_collaboration": " join c3_job_collaboration jcol on j.id = jcol.job_id "
    },
    "piConfig": {
        "mongoReferenceVariable": "Candidate ID",
        "sqlMongoReferenceReplace": ", concat(ja.first_name, ' ', ja.last_name) as 'Candidate Name', ja.first_name as 'First Name', ja.last_name as 'Last Name', j.hiring_manager as 'Hiring Manager', ja.current_status as 'Offer Status', j.job_title as 'Indent Title', if(j.status = 1, 'Open', 'Closed') as 'Indent Status', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Hire Type' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Hire Type', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'TypeOfHire' limit 1 ) as 'Offer Type of Hire', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'joiningdate' limit 1 ) as 'Joining Date', ( select DATE_FORMAT(fieldValue, '%M') from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'joiningdate' limit 1 ) AS 'Joining Month', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'contractdate' limit 1 ) as 'Contract End Date', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Opportunity/Project Name' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Opportunity/Project Name', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Business Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Business Unit', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Department Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Department Unit', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'grade' limit 1 ) as 'Grade', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Assignment Location' WHERE rfv.requisition_id = j.id limit 1 ) AS 'Assignment Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'loc' limit 1 ) as 'Offer Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'wloc' limit 1 ) as 'Base Location', ( select if( ( select count(id) > 0 from c3_offernfitment_custom where applicantId = ja.id and fieldName = 'salaryStructure' and ( (fieldValue = 'India-SubCon') or (fieldValue = 'US-C2C') or (fieldValue = 'Canada-C2C') ) limit 1 ),( select fieldValue from c3_offernfitment_custom where applicantId = ja.id and fieldName = 'workAddress' limit 1 ), '' ) ) as 'Work Location', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'InternalCode' limit 1 ) as 'Internal Location Code', (select if((select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'workAddress' limit 1 )='WFH',(select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'address1' limit 1 ),(select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'isworklocation' limit 1 ))) as 'Address of Work Location', ja.email_id as 'Email', j.skill_set as 'Primary Skill', ( select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId = ja.id and fieldName = 'jobTitle' limit 1 ) as 'Designation', ( CASE WHEN LOCATE('\"EType\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"EType\"', ja.applyFieldsObject) + 9, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"EType\"', ja.applyFieldsObject) + 9 ) - (LOCATE('\"EType\"', ja.applyFieldsObject) + 9) ), ',', '' ) ELSE '' END ) AS 'Employment Type', ( CASE WHEN LOCATE('\"experience\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"experience\"', ja.applyFieldsObject) + 14, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"experience\"', ja.applyFieldsObject) + 14 ) - ( LOCATE('\"experience\"', ja.applyFieldsObject) + 14 ) ), ',', '' ) ELSE '' END ) AS 'Total Experience', ( CASE WHEN LOCATE('\"trexp\"', ja.applyFieldsObject) > 0 THEN REPLACE( SUBSTRING( ja.applyFieldsObject, LOCATE('\"trexp\"', ja.applyFieldsObject) + 9, LOCATE( '\"', ja.applyFieldsObject, LOCATE('\"trexp\"', ja.applyFieldsObject) + 9 ) - (LOCATE('\"trexp\"', ja.applyFieldsObject) + 9) ), ',', '' ) ELSE '' END ) AS 'Relevant Experience', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Recruiter ID' WHERE rfv.requisition_id = j.id LIMIT 1 ) AS 'Recruiter ID', ( select ( CASE WHEN LOCATE( '\"fieldName\":\"Recruiter Name\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43 ) - ( LOCATE( '\"fieldName\":\"Recruiter Name\"', offit.customFields ) + 43 ) ) WHEN LOCATE( '\"fieldName\": \"Recruiter Name\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43 ) - ( LOCATE( '\"fieldName\": \"Recruiter Name\"', offit.customFields ) + 43 ) ) ELSE '' END ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Recruiter Name', ( select date_format(aa.actedOn, '%d-%m-%y') from ApplyAction as aa where aa.applyId = ja.id and aa.actionCode = 'To be Hired' order by aa.id desc limit 1 ) as 'To Be Hired On', ( case when j.deptFullCode like '%.US%' then 'United States' when j.deptFullCode like '%United States.%' then 'United States' when j.deptFullCode like 'persistent.North America.Industry.Industrial Services.PLM Services' then 'North America' when j.deptFullCode like '%UK.%' then 'United Kingdom' when j.deptFullCode like '%APJ.%' then 'Asia Pacific' when j.deptFullCode like '%EU.%' then 'Europe' when j.deptFullCode like '%CAN%' then 'Canada' when j.deptFullCode like '%Canada.%' then 'Canada' when j.deptFullCode like '%MEX.%' then 'Mexico' when j.deptFullCode like '%Mexico%' then 'Mexico' when j.deptFullCode like '%India.%' then 'India' when j.deptFullCode like '%.India%' then 'India' when j.deptFullCode like '%Australia.%' then 'Australia' when j.deptFullCode like '%Sri Lanka%' then 'Sri Lanka' when j.deptFullCode like '%Netherlands.%' then 'Netherlands' when j.deptFullCode like '%MENA.%' then 'Middle east and North Africa' else 'RoW' end ) as 'Indent Country', (select fieldValue from c3_offernfitment_custom ofc where ofc.applicantId =ja.id and fieldName = 'country' limit 1) as 'Offered Country','' as 'Visa Type/Green Card/EAD/Citizen Value', '' as 'Office Laptop Required?', '' as 'Office Phone Required?', '' as 'If H1 then I-94 Start Date', '' as 'If H1 then I-94 End Date', '' as 'Address of Residence (Line 2)', '' as 'City of Residence', '' as 'State/Prov of Residence', '' as 'Country of Residence', '' as 'Zip Code of Residence', ( select ( CASE WHEN LOCATE( '\"fieldName\":\"Job Family\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39 ) - ( LOCATE( '\"fieldName\":\"Job Family\"', offit.customFields ) + 39 ) ) WHEN LOCATE( '\"fieldName\": \"Job Family\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39 ) - ( LOCATE( '\"fieldName\": \"Job Family\"', offit.customFields ) + 39 ) ) ELSE '' END ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Job Family', ja.phone_no as 'Mobile Phone', (SUBSTRING(ja.applyFieldsObject, LOCATE('\"formerEmployee\"', ja.applyFieldsObject) + length('\"formerEmployee\":\"'), LOCATE(',', ja.applyFieldsObject, LOCATE('\"formerEmployee\"', ja.applyFieldsObject)) - LOCATE('\"formerEmployee\"', ja.applyFieldsObject) - (length('\"formerEmployee\":\"') + 1))) as 'Is Ex-Employee?', (SUBSTRING(ja.applyFieldsObject, LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject) + length('\"pleaseshareyourEmployeeId\":\"'), LOCATE(',', ja.applyFieldsObject, LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject)) - LOCATE('\"pleaseshareyourEmployeeId\"', ja.applyFieldsObject) - (length('\"pleaseshareyourEmployeeId\":\"') + 1))) as 'If yes Employee No.', ( select date_format( ( CASE WHEN LOCATE( '\"fieldName\":\"Contract End Date\",\"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46 ) - ( LOCATE( '\"fieldName\":\"Contract End Date\"', offit.customFields ) + 46 ) ) WHEN LOCATE( '\"fieldName\": \"Contract End Date\", \"fieldValue\"', offit.customFields ) > 0 THEN SUBSTRING( offit.customFields, LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46, LOCATE( '\"', offit.customFields, LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46 ) - ( LOCATE( '\"fieldName\": \"Contract End Date\"', offit.customFields ) + 46 ) ) ELSE '' END ), '%d-%m-%y' ) from c3_offer_and_fitment offit where offit.applicant_id = ja.id and offit.isFinalRecord = 1 order by offit.lastUpdatedTime desc limit 1 ) AS 'Contract End Date', j.reference_number as 'Candidate Identifier', ( SELECT rfv.value FROM c3_requisition_field_values rfv INNER JOIN c3_requisition_fields rf ON rfv.requisition_field_id = rf.id AND rf.field_name = 'Organization Unit' WHERE rfv.requisition_id = j.id limit 1 ) AS 'OU', '' as 'Geography', '' as 'Laptop Shipment Address Line 1', '' as 'Laptop Shipment Address Line 2', '' as 'Laptop Shipment City', '' as 'Laptop Shipment State', '' as 'Laptop Shipment Country', '' as 'Laptop Shipment Zipcode'",
        "piFields": [
            "applyID",
            "profile.PersonalDetails.firstName",
            "profile.candidateDetails.aadhar",
            "profile.candidateDetails.panNumber",
            "profile.candidateDetails.socialSecurity",
            "profile.candidateDetails.socialInsur",
            "profile.candidateDetails.gender",
            "profile.candidateDetails.dateOfBirth"
        ],
        "piColumnHeading": {
            "National Id Number": "sourceTypeFields.$concat",
            "Aadhaar Number": "profile.candidateDetails.aadhar",
            "Gender": "profile.candidateDetails.gender",
            "Date of Birth": "profile.candidateDetails.dateOfBirth"
        },
        "piConcatFields": {
            "sourceTypeFields.$concat": [
                "profile.candidateDetails.panNumber",
                "profile.candidateDetails.socialSecurity",
                "profile.candidateDetails.socialInsur"
            ]
        }
    }
}